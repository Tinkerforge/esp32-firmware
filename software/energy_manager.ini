[env:energy_manager]
extends = env:base_esp32_ethernet

lib_deps = ${env:base_esp32_ethernet.lib_deps}
           https://github.com/Tinkerforge/WireGuard-ESP32-Arduino#80b5c79d
           https://github.com/Tinkerforge/modbus-esp8266#a6affca4

build_flags = ${env:base_esp32_ethernet.build_flags}
              -DMETER_VALUE_HISTORY_VALUE_TYPE=int32_t
              -DMETER_VALUE_HISTORY_VALUE_MIN=-9999999
              -DMETER_VALUE_HISTORY_VALUE_MAX=9999999
              -DMETERS_SLOTS=7
              -DMETERS_SLOT_0_DEFAULT_CLASS=MeterClassID::EnergyManager
              ;-DTF_IGNORE_DEVICE_IDS=2169
              ;2169: Energy Manager Bricklet

custom_name = energy_manager
custom_config_type = wem
custom_host_prefix = wem
custom_display_name = WARP Energy Manager
custom_manual_url = https://www.warp-charger.com/energy-manager.html#documents
custom_apidoc_url = https://www.warp-charger.com/api.html
custom_firmware_url = https://www.warp-charger.com/energy-manager.html#firmware
custom_require_firmware_info = 1
custom_web_build_flags = METERS_SLOTS = 7
                         IS_ENERGY_MANAGER = 1

custom_backend_modules = ESP32 Ethernet Brick
                         Watchdog
                         Uptime Tracker
                         Network
                         Ethernet
                         Wifi
                         Wireguard
                         NTP
                         Mqtt
                         Http
                         WS
                         Event
                         Firmware Update
                         Charge Manager
                         CM Networking
                         Rtc
                         Rtc Bricklet
                         Meters
                         Meters EM
                         Meters API
                         Meters Modbus TCP
                         Meters Sun Spec
                         Meters Legacy API
                         Energy Manager
                         Power Manager
                         Em Rtc
                         EM SDcard
                         Authentication
                         Hidden Proxy
                         Device Name
                         Coredump
                         Pwa
                         Certs
                         Automation

custom_frontend_modules = Device Name
                          EM Energy Analysis
                          Energy Manager
                          Power Manager
                          Meters
                          Meters EM
                          Meters API
                          Meters Sun Spec
                          Charge Manager
                          Network
                          Wifi
                          Ethernet
                          Wireguard
                          Mqtt
                          Certs
                          Automation
                          NTP
                          Rtc
                          EM SDcard
                          EM Debug
                          Authentication
                          Event Log
                          Firmware Update
                          Energy Manager Group
                          Network Group
                          Interfaces Group
                          System Group
                          Energy Manager Branding

custom_frontend_components = EM Energy Analysis
                             Energy Manager Group $ Open
                               Power Manager
                               Meters
                               Charge Manager
                               Automation
                             Energy Manager Group $ Close
                             Network Group $ Open
                               Network
                               Wifi | Wifi STA
                               Wifi | Wifi AP
                               Ethernet
                               Wireguard
                             Network Group $ Close
                             Interfaces Group $ Open
                               Mqtt
                             Interfaces Group $ Close
                             System Group $ Open
                               Certs
                               NTP
                               Rtc
                               EM SDcard
                               EM Debug
                               Authentication
                               Event Log
                               Firmware Update
                             System Group $ Close

custom_frontend_status_components = Device Name
                                    Power Manager
                                    Energy Manager
                                    EM Energy Analysis
                                    Charge Manager
                                    Wifi
                                    Ethernet
                                    Wireguard
                                    Mqtt
                                    NTP

; ============================================================================

[env:energy_manager_debug]
extends = env:energy_manager
custom_frontend_debug = true

; ============================================================================

[env:energy_manager_web]
extends = env:energy_manager
custom_web_only = true
custom_frontend_debug = true
